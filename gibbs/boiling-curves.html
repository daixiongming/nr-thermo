---
layout:  post
title:   "Calculation of the boiling curves"
stitle:  "Boiling curves"
date:    2005-06-20 23:57:32 +0100
---

			<p>Knowing that the chemical excess potential can be obtained from the excess Gibbs potential using the expression:</p>
			<!-- Latex: \mu_i^E={\left(\frac{\partial g^E}{\partial n_i}\right)}_{T,p,n_{j\neq i}} -->
			<p class="center"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>&#956;</mi><mi>i</mi><mi>E</mi></msubsup><mo>=</mo><msub><mfenced><mfrac><mrow><mo>&#8706;</mo><msup><mi>g</mi><mi>E</mi></msup></mrow><mrow><mo>&#8706;</mo><msub><mi>n</mi><mi>i</mi></msub></mrow></mfrac></mfenced><mrow><mi>T</mi><mo>,</mo><mi>p</mi><mo>,</mo><msub><mi>n</mi><mrow><mi>j</mi><mo>&#8800;</mo><mi>i</mi></mrow></msub></mrow></msub></math></p>

			<p>And taking into account the <a href="{{ site.url }}{{ page.dir }}/gibbs-correlation.html">Redlich-Kister equation</a>:</p>
			<!-- Latex: \mu_1^E=x_2^2\left[A_0+\sum_{j=1}^{M-1}A_j\left(2x_1-1\right)^{j-1}\left\{2\left(1+j\right)x_1-1\right\}\right] -->
			<p class="center"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>&#956;</mi><mn>1</mn><mi>E</mi></msubsup><mo>=</mo><msubsup><mi>x</mi><mn>2</mn><mn>2</mn></msubsup><mfenced open="[" close="]"><mrow><msub><mi>A</mi><mn>0</mn></msub><mo>+</mo><munderover><mo>&#8721;</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>M</mi><mo>-</mo><mn>1</mn></mrow></munderover><msub><mi>A</mi><mi>j</mi></msub><msup><mfenced><mrow><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><mo>-</mo><mn>1</mn></mrow></mfenced><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></msup><mfenced open="{" close="}"><mrow><mn>2</mn><mfenced><mrow><mn>1</mn><mo>+</mo><mi>j</mi></mrow></mfenced><msub><mi>x</mi><mn>1</mn></msub><mo>-</mo><mn>1</mn></mrow></mfenced></mrow></mfenced></math></p>

			<!-- Latex: \mu_2^E=x_1^2\left[A_0+\sum_{j=1}^{M-1}A_j\left(2x_1-1\right)^{j-1}\left\{2\left(1+j\right)x_1-\left(1+2j\right)\right\}\right] -->
			<p class="center"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>&#956;</mi><mn>2</mn><mi>E</mi></msubsup><mo>=</mo><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup><mfenced open="[" close="]"><mrow><msub><mi>A</mi><mn>0</mn></msub><mo>+</mo><munderover><mo>&#8721;</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>M</mi><mo>-</mo><mn>1</mn></mrow></munderover><msub><mi>A</mi><mi>j</mi></msub><msup><mfenced><mrow><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><mo>-</mo><mn>1</mn></mrow></mfenced><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></msup><mfenced open="{" close="}"><mrow><mn>2</mn><mfenced><mrow><mn>1</mn><mo>+</mo><mi>j</mi></mrow></mfenced><msub><mi>x</mi><mn>1</mn></msub><mo>-</mo><mfenced><mrow><mn>1</mn><mo>+</mo><mn>2</mn><mi>j</mi></mrow></mfenced></mrow></mfenced></mrow></mfenced></math></p>

			<p>The equations of the <a href="{{ site.baseurl }}/{{ page.submenu }}/gibbs-potential.html">chemical excess potentials</a> can be rewritten as:</p>
			<!-- Latex: y_1=\frac{x_1P_1^0}P\text{exp}\left[\frac{\mu_1^E-\left(P-P_1^0\right)\left(B_{11}-\nu_1^{0L}\right)-\delta_{12}y_2^2P}{RT}\right] -->
			<p class="center"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mfrac><mrow><msub><mi>x</mi><mn>1</mn></msub><msubsup><mi>P</mi><mn>1</mn><mn>0</mn></msubsup></mrow><mi>P</mi></mfrac><mtext>exp</mtext><mfenced open="[" close="]"><mfrac><mrow><msubsup><mi>&#956;</mi><mn>1</mn><mi>E</mi></msubsup><mo>-</mo><mfenced><mrow><mi>P</mi><mo>-</mo><msubsup><mi>P</mi><mn>1</mn><mn>0</mn></msubsup></mrow></mfenced><mfenced><mrow><msub><mi>B</mi><mn>11</mn></msub><mo>-</mo><msubsup><mi>&#957;</mi><mn>1</mn><mrow><mn>0</mn><mi>L</mi></mrow></msubsup></mrow></mfenced><mo>-</mo><msub><mi>&#948;</mi><mn>12</mn></msub><msubsup><mi>y</mi><mn>2</mn><mn>2</mn></msubsup><mi>P</mi></mrow><mrow><mi>R</mi><mi>T</mi></mrow></mfrac></mfenced></math></p>

			<!-- Latex: y_2=\frac{x_2P_2^0}P\text{exp}\left[\frac{\mu_2^E-\left(P-P_2^0\right)\left(B_{22}-\nu_2^{0L}\right)-\delta_{12}y_1^2P}{RT}\right] -->
			<p class="center"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><mfrac><mrow><msub><mi>x</mi><mn>2</mn></msub><msubsup><mi>P</mi><mn>2</mn><mn>0</mn></msubsup></mrow><mi>P</mi></mfrac><mtext>exp</mtext><mfenced open="[" close="]"><mfrac><mrow><msubsup><mi>&#956;</mi><mn>2</mn><mi>E</mi></msubsup><mo>-</mo><mfenced><mrow><mi>P</mi><mo>-</mo><msubsup><mi>P</mi><mn>2</mn><mn>0</mn></msubsup></mrow></mfenced><mfenced><mrow><msub><mi>B</mi><mn>22</mn></msub><mo>-</mo><msubsup><mi>&#957;</mi><mn>2</mn><mrow><mn>0</mn><mi>L</mi></mrow></msubsup></mrow></mfenced><mo>-</mo><msub><mi>&#948;</mi><mn>12</mn></msub><msubsup><mi>y</mi><mn>1</mn><mn>2</mn></msubsup><mi>P</mi></mrow><mrow><mi>R</mi><mi>T</mi></mrow></mfrac></mfenced></math></p>

			<p>where:</p>
			<!-- Latex: x_1+x_2=1;\qquad y_1+y_2=1 -->
			<p class="center"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn><mo>;</mo><mo>&#160;&#160;&#160;&#160;</mo><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn></math></p>


			<h2>Procedure</h2>
			<p>Having set a value for the molar fraction <em>x<sub>1</sub></em>, and taking into account the <em>A<sub>j</sub></em> coefficients of table 5, we obtain the values of the <em>&mu;<sub>i</sub><sup></sup></em> from their equations above. Then we must solve the system of non-linear equations given by <em>y<sub>1</sub></em> and <em>y<sub>2</sub></em> to obtain the values of <em>y<sub>1</sub></em> and <em>P</em>.

			<h2>Method of Broyden of the multidimensional secant</h2>
			<p>Allows the calculation of the roots of a non-linear system of equations using a method of global convergence (<em>in other words, converges to a solution with independence of the initial approximation used</em>).</p>

			<p>The equations must be written as functions that equal to zero, so they have the following form:</p>
			<!-- Latex: f_{1=}y_1-\frac{x_1P_1^0}P\text{exp}\left[\frac{\mu_1^E-\left(P-P_1^0\right)\left(B_{11}-\nu_1^{0L}\right)-\delta_{12}y_2^2P}{RT}\right]=0 -->
			<p class="center"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mrow><mn>1</mn><mo>=</mo></mrow></msub><msub><mi>y</mi><mn>1</mn></msub><mo>-</mo><mfrac><mrow><msub><mi>x</mi><mn>1</mn></msub><msubsup><mi>P</mi><mn>1</mn><mn>0</mn></msubsup></mrow><mi>P</mi></mfrac><mtext>exp</mtext><mfenced open="[" close="]"><mfrac><mrow><msubsup><mi>&#956;</mi><mn>1</mn><mi>E</mi></msubsup><mo>-</mo><mfenced><mrow><mi>P</mi><mo>-</mo><msubsup><mi>P</mi><mn>1</mn><mn>0</mn></msubsup></mrow></mfenced><mfenced><mrow><msub><mi>B</mi><mn>11</mn></msub><mo>-</mo><msubsup><mi>&#957;</mi><mn>1</mn><mrow><mn>0</mn><mi>L</mi></mrow></msubsup></mrow></mfenced><mo>-</mo><msub><mi>&#948;</mi><mn>12</mn></msub><msubsup><mi>y</mi><mn>2</mn><mn>2</mn></msubsup><mi>P</mi></mrow><mrow><mi>R</mi><mi>T</mi></mrow></mfrac></mfenced><mo>=</mo><mn>0</mn></math></p>

			<!--Latex f_{2=}y_2-\frac{x_2P_2^0}P\text{exp}\left[\frac{\mu_2^E-\left(P-P_2^0\right)\left(B_{22}-\nu_2^{0L}\right)-\delta_{12}y_1^2P}{RT}\right]=0-->
			<p class="center"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mrow><mn>2</mn><mo>=</mo></mrow></msub><msub><mi>y</mi><mn>2</mn></msub><mo>-</mo><mfrac><mrow><msub><mi>x</mi><mn>2</mn></msub><msubsup><mi>P</mi><mn>2</mn><mn>0</mn></msubsup></mrow><mi>P</mi></mfrac><mtext>exp</mtext><mfenced open="[" close="]"><mfrac><mrow><msubsup><mi>&#956;</mi><mn>2</mn><mi>E</mi></msubsup><mo>-</mo><mfenced><mrow><mi>P</mi><mo>-</mo><msubsup><mi>P</mi><mn>2</mn><mn>0</mn></msubsup></mrow></mfenced><mfenced><mrow><msub><mi>B</mi><mn>22</mn></msub><mo>-</mo><msubsup><mi>&#957;</mi><mn>2</mn><mrow><mn>0</mn><mi>L</mi></mrow></msubsup></mrow></mfenced><mo>-</mo><msub><mi>&#948;</mi><mn>12</mn></msub><msubsup><mi>y</mi><mn>1</mn><mn>2</mn></msubsup><mi>P</mi></mrow><mrow><mi>R</mi><mi>T</mi></mrow></mfrac></mfenced><mo>=</mo><mn>0</mn></math></p>

			<aside class="important">
				<h2>Library functions (<em>Numerical Recipes</em>):</h2>
				<dl>
					<dt><strong><em>broydn()</em>:</strong><a id="broydn" class="def" href="#function"><span class="visuallyhidden">Go to function call</span></a></dt>
					<dd>it takes as arguments the vector <code>x[]</code> (<em>which will contain the solution</em>), the logic variable <code>check</code> (<em>which returns <strong>true</strong> if the system converges or <strong>false</strong> if not</em>), and the variable <code>vecfunc</code> (<em>a pointer to the user function</em>).
</dd>
				</dl>
			</aside>

			<p>Function <code>broydn()</code> also calls for other NR routines, which are <code>fdjac.c</code>, <code>fmin1.c</code>, <code>lnsrch.c</code>, <code>qrdcmp.c</code>, <code>qrupdt.c</code>, <code>rsolv.c</code> and <code>rotate.c</code>.

			<aside class="important">
				<h2>User functions:</h2>
				<dl>
					<dt><strong><em>vecfunc()</em>:</strong><a id="vecfunc" class="def" href="#function"><span class="visuallyhidden">Go to function call</span></a></dt>
					<dd>the user must implement a function that contains the system of equations to solve and must take the following arguments: a vector <code>x[]</code> (<em>which contains the variables to determine</em>) and the vector <code>f[]</code> (<em>which contains the values of the <em>f<sub>i</sub></em> functions</em>).
</dd>
				</dl>
			</aside>

			<p>We will also use a slightly different version of the Redlich-Kister snippet to keep the A matrix in order to recalculate it later.</p>

			<table summary="Values calculated from the experimental values.">
				<caption>Values calculated from the experimental values.</caption>
				<thead>
					<tr>
						<th>x<sub>1</sub></th>
						<th>m<sup>E</sup><sub>1</sub> [J/mol]</th>
						<th>m<sup>E</sup><sub>2</sub> [J/mol]</th>
						<th>g<sup>E</sup> [J/mol]</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>0.0000</td><td>0.0</td><td>0.0</td><td>0.0</td>
					<tr>
					</tr>
						<td>0.0912</td><td>3145.9</td><td>35.8</td><td>319.5</td>
					<tr>
					</tr>
						<td>0.2073</td><td>2462.1</td><td>162.0</td><td>638.8</td>
					<tr>
					</tr>
						<td>0.3156</td><td>1921.4</td><td>354.0</td><td>848.7</td>
					<tr>
					</tr>
						<td>0.4000</td><td>1538.1</td><td>571.1</td><td>957.9</td>
					<tr>
					</tr>
						<td>0.4694</td><td>1251.8</td><td>789.9</td><td>1006.7</td>
					<tr>
					</tr>
						<td>0.5545</td><td>947.3</td><td>1112.3</td><td>1020.8</td>
					<tr>
					</tr>
						<td>0.5915</td><td>818.6</td><td>1281.6</td><td>1007.8</td>
					<tr>
					</tr>
						<td>0.6418</td><td>658.3</td><td>1539.8</td><td>974.0</td>
					<tr>
					</tr>
						<td>0.6618</td><td>609.5</td><td>1656.5</td><td>963.6</td>
					<tr>
					</tr>
						<td>0.7226</td><td>437.4</td><td>2040.5</td><td>882.1</td>
					<tr>
					</tr>
						<td>0.7646</td><td>331.7</td><td>2346.1</td><td>805.9</td>
					<tr>
					</tr>
						<td>0.8098</td><td>232.7</td><td>2725.7</td><td>706.9</td>
					<tr>
					</tr>
						<td>0.8245</td><td>222.6</td><td>2829.1</td><td>680.1</td>
					<tr>
					</tr>
						<td>0.8419</td><td>171.2</td><td>3020.4</td><td>621.6</td>
					<tr>
					</tr>
						<td>0.8703</td><td>121.1</td><td>3303.0</td><td>533.8</td>
					<tr>
					</tr>
						<td>0.8879</td><td>90.9</td><td>3504.0</td><td>473.5</td>
					<tr>
					</tr>
						<td>0.9597</td><td>30.5</td><td>4374.5</td><td>205.6</td>
					<tr>
					</tr>
						<td>0.9720</td><td>16.4</td><td>4587.4</td><td>144.4</td>
					<tr>
					</tr>
						<td>0.9874</td><td>6.3</td><td>4779.3</td><td>66.4</td>
					<tr>
					</tr>
						<td>1.0000</td><td>0.0</td><td>0.0</td><td>0.0</td>
					</tr>
				</tbody>
			</table>			

			<p class="center"><img src="{{ '/img/gibbs-boiling1.png' | prepend: site.baseurl }}" width="648" height="483" alt="Experimental boiling curve"></p>

			<table summary="Values calculated from the Redlich-Kister fit.">
				<caption>Values calculated from the Redlich-Kister fit.</caption>
				<thead>
					<tr>
						<th>x<sub>1</sub></th>
						<th>m<sup>E</sup><sub>1</sub> [J/mol]</th>
						<th>m<sup>E</sup><sub>2</sub> [J/mol]</th>
						<th>g<sup>E</sup> [J/mol]</th>
					</tr>
				</thead>
				<tbody>
					<tr>					<tr>
						<td>0.0000</td><td>3795.4</td><td>0.0</td><td>0.0</td>
					<tr>
					</tr>
						<td>0.0912</td><td>3247.5</td><td>24.4</td><td>318.3</td>
					<tr>
					</tr>
						<td>0.2073</td><td>2577.3</td><td>132.1</td><td>639.0</td>
					<tr>
					</tr>
						<td>0.3156</td><td>2026.0</td><td>308.4</td><td>850.5</td>
					<tr>
					</tr>
						<td>0.4000</td><td>1652.3</td><td>493.4</td><td>956.9</td>
					<tr>
					</tr>
						<td>0.4694</td><td>1377.1</td><td>678.6</td><td>1006.5</td>
					<tr>
					</tr>
						<td>0.5545</td><td>1070.6</td><td>956.9</td><td>1019.9</td>
					<tr>
					</tr>
						<td>0.5915</td><td>945.6</td><td>1100.9</td><td>1009.0</td>
					<tr>
					</tr>
						<td>0.6418</td><td>782.1</td><td>1326.5</td><td>977.1</td>
					<tr>
					</tr>
						<td>0.6618</td><td>719.0</td><td>1427.7</td><td>958.7</td>
					<tr>
					</tr>
						<td>0.7226</td><td>534.3</td><td>1785.8</td><td>881.4</td>
					<tr>
					</tr>
						<td>0.7646</td><td>413.9</td><td>2087.9</td><td>807.9</td>
					<tr>
					</tr>
						<td>0.8098</td><td>293.3</td><td>2476.7</td><td>708.5</td>
					<tr>
					</tr>
						<td>0.8245</td><td>256.6</td><td>2619.8</td><td>671.3</td>
					<tr>
					</tr>
						<td>0.8419</td><td>215.1</td><td>2801.2</td><td>624.0</td>
					<tr>
					</tr>
						<td>0.8703</td><td>152.8</td><td>3127.5</td><td>538.6</td>
					<tr>
					</tr>
						<td>0.8879</td><td>118.1</td><td>3350.4</td><td>480.4</td>
					<tr>
					</tr>
						<td>0.9597</td><td>17.6</td><td>4454.2</td><td>196.4</td>
					<tr>
					</tr>
						<td>0.9720</td><td>8.7</td><td>4679.2</td><td>139.5</td>
					<tr>
					</tr>
						<td>0.9874</td><td>1.8</td><td>4977.7</td><td>64.5</td>
					<tr>
					</tr>
						<td>1.0000</td><td>0.0</td><td>5236.6</td><td>0.0</td>
					</tr>
				</tbody>
			</table>

			<p class="center"><img src="{{ '/img/gibbs-boiling2.png' | prepend: site.baseurl }}" width="648" height="483" alt="Redlich-Kister boiling curve"></p>

			<table summary="New values calculated with the Broyden method.">
				<caption>New values calculated with the Broyden method.</caption>
				<thead>
					<tr>
						<th>x<sub>1</sub></th>
						<th>y<sub>1</sub></th>
						<th>y<sub>2</sub></th>
						<th>P [KPa]</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>0,0000</td><td>0,0000</td><td>1,0000</td><td>30,636</td>
					<tr>
					</tr>
						<td>0,0912</td><td>0,1916</td><td>0,8084</td><td>35,031</td>
					<tr>
					</tr>
						<td>0,2073</td><td>0,3106</td><td>0,6894</td><td>37,699</td>
					<tr>
					</tr>
						<td>0,3156</td><td>0,3739</td><td>0,6261</td><td>38,644</td>
					<tr>
					</tr>
						<td>0,4000</td><td>0,4059</td><td>0,5941</td><td>38,861</td>
					<tr>
					</tr>
						<td>0,4694</td><td>0,4268</td><td>0,5732</td><td>38,789</td>
					<tr>
					</tr>
						<td>0,5545</td><td>0,4507</td><td>0,5493</td><td>38,530</td>
					<tr>
					</tr>
						<td>0,5915</td><td>0,4594</td><td>0,5406</td><td>38,345</td>
					<tr>
					</tr>
						<td>0,6418</td><td>0,4718</td><td>0,5282</td><td>38,051</td>
					<tr>
					</tr>
						<td>0,6618</td><td>0,4777</td><td>0,5223</td><td>38,023</td>
					<tr>
					</tr>
						<td>0,7226</td><td>0,4950</td><td>0,5050</td><td>37,453</td>
					<tr>
					</tr>
						<td>0,7646</td><td>0,5101</td><td>0,4899</td><td>36,895</td>
					<tr>
					</tr>
						<td>0,8098</td><td>0,5311</td><td>0,4689</td><td>36,096</td>
					<tr>
					</tr>
						<td>0,8245</td><td>0,5446</td><td>0,4554</td><td>35,694</td>
					<tr>
					</tr>
						<td>0,8419</td><td>0,5522</td><td>0,4478</td><td>35,223</td>
					<tr>
					</tr>
						<td>0,8703</td><td>0,5772</td><td>0,4228</td><td>34,143</td>
					<tr>
					</tr>
						<td>0,8879</td><td>0,5956</td><td>0,4044</td><td>33,349</td>
					<tr>
					</tr>
						<td>0,9597</td><td>0,7552</td><td>0,2448</td><td>27,689</td>
					<tr>
					</tr>
						<td>0,9720</td><td>0,8046</td><td>0,1954</td><td>26,156</td>
					<tr>
					</tr>
						<td>0,9874</td><td>0,8958</td><td>0,1042</td><td>23,740</td>
					<tr>
					</tr>
						<td>1,0000</td><td>1,0000</td><td>0,0000</td><td>21,457</td>
					</tr>
				</tbody>
			</table>

			<p class="center">
				<img src="{{ '/img/gibbs-boiling3.png' | prepend: site.baseurl }}" width="550" height="346" alt="Experimental m1E comparison">
				<img src="{{ '/img/gibbs-boiling4.png' | prepend: site.baseurl }}" width="550" height="346" alt="Experimental m2E comparison">
			</p>

